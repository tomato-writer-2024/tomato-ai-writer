# 番茄小说AI写作工具 - 配置检查清单

> **按照清单逐项检查，确保配置无误**

---

## 使用说明

- ✅ 已完成
- ❌ 未完成
- ⚠️ 需要注意

---

## 一、环境变量配置

### 应用基础配置

- [ ] `.env.local` 文件已创建（从 `.env.production.example` 复制）
- [ ] `NEXT_PUBLIC_APP_NAME` 已设置为"番茄小说AI写作助手"
- [ ] `NEXT_PUBLIC_BASE_URL` 已设置正确
  - 本地开发：`http://localhost:5000`
  - 生产环境：`https://yourdomain.com`
- [ ] `NODE_ENV` 已设置为 `production`

### JWT密钥配置

- [ ] `JWT_SECRET` 已设置（至少32位随机字符串）
- [ ] `JWT_REFRESH_SECRET` 已设置（至少32位随机字符串）
- [ ] JWT密钥已妥善保存，未泄露
- [ ] 生产环境已修改默认密钥

---

## 二、数据库配置

### 基础配置

- [ ] `DATABASE_URL` 已正确配置
  - 格式：`postgresql://username:password@host:port/database`
  - 示例：`postgresql://postgres:password@localhost:5432/tomato_ai`

### 数据库迁移

- [ ] 已执行 `pnpm run migrate`
- [ ] 迁移成功，无错误
- [ ] 数据库表已创建（users, novels, chapters, content_stats等）
- [ ] 索引已正确创建

### 管理员账号

- [ ] 已执行 `pnpm run init-admin`
- [ ] 超级管理员账号已创建
- [ ] 管理员账号可以正常登录

### 数据库连接测试

- [ ] 应用可以正常连接数据库
- [ ] 可以读取数据
- [ ] 可以写入数据
- [ ] 查询响应速度正常

---

## 三、豆包AI配置

### API Key

- [ ] 已注册火山引擎账号
- [ ] 已完成实名认证
- [ ] 已开通豆包大模型服务
- [ ] 已创建API Key
- [ ] API Key已正确配置到 `DOUBAO_API_KEY`
- [ ] API Key未泄露，已妥善保存

### 模型选择

- [ ] `DOUBAO_MODEL` 已设置
  - `doubao-pro-4k`：Pro版，4K上下文（推荐）
  - `doubao-pro-32k`：Pro版，32K上下文
  - `doubao-pro-128k`：Pro版，128K上下文
  - `dobbao-lite-4k`：Lite版，4K上下文（快速）

### AI功能测试

- [ ] 章节生成功能正常
- [ ] 精修润色功能正常
- [ ] 智能续写功能正常
- [ ] 双视角评分功能正常
- [ ] AI首字响应时间 < 1秒

---

## 四、邮件服务配置

### SMTP配置（可选）

如果配置了邮件服务，检查以下项目：

- [ ] 已选择邮件服务提供商（163/QQ/Gmail）
- [ ] 已开通SMTP服务
- [ ] 已获取授权码（不是登录密码）
- [ ] `EMAIL_HOST` 已正确配置
- [ ] `EMAIL_PORT` 已正确配置
- [ ] `EMAIL_SECURE` 已正确配置
- [ ] `EMAIL_USER` 已正确配置
- [ ] `EMAIL_PASS` 已正确配置（授权码）
- [ ] `EMAIL_FROM` 已正确配置
- [ ] `EMAIL_MOCK_MODE` 已设置为 `false`（真实发送）

### 邮件功能测试

- [ ] 注册验证邮件可以正常发送
- [ ] 邮箱可以正常收到验证邮件
- [ ] 点击验证链接可以完成验证
- [ ] 密码重置邮件可以正常发送
- [ ] 邮件内容格式正确

### 如果未配置邮件服务

- [ ] `EMAIL_MOCK_MODE` 已设置为 `true`
- [ ] 知道邮件不会实际发送
- [ ] 知道用户注册和密码重置功能受限

---

## 五、对象存储配置

### S3配置

- [ ] `S3_ENDPOINT` 已正确配置
- [ ] `S3_ACCESS_KEY` 已正确配置
- [ ] `S3_SECRET_KEY` 已正确配置
- [ ] `S3_BUCKET` 已正确配置
- [ ] `S3_REGION` 已正确配置

### 文件上传配置

- [ ] `MAX_FILE_SIZE` 已设置（默认10MB）
- [ ] `ALLOWED_FILE_TYPES` 已设置

### 文件功能测试

- [ ] 可以上传封面图片
- [ ] 可以上传Word文件
- [ ] 可以上传PDF文件
- [ ] 可以上传TXT文件
- [ ] 可以下载导出的文件
- [ ] 文件导入功能正常
- [ ] 文件导出功能正常

---

## 六、安全配置

### 密码配置

- [ ] `PASSWORD_MIN_LENGTH` 已设置（至少8位）
- [ ] 密码强度验证已启用
- [ ] 密码已使用bcrypt加密存储

### Token配置

- [ ] `RESET_TOKEN_EXPIRES_IN` 已设置（默认30分钟）
- [ ] `ACCESS_TOKEN_EXPIRES_IN` 已设置（默认24小时）
- [ ] `REFRESH_TOKEN_EXPIRES_IN` 已设置（默认7天）

### 限流配置

- [ ] `RATE_LIMIT_MAX_REQUESTS_PER_HOUR` 已设置（默认100）
- [ ] `RATE_LIMIT_WINDOW_SECONDS` 已设置（默认3600）

### 安全检查

- [ ] 所有敏感信息未提交到代码仓库
- [ ] JWT密钥足够复杂且已更改
- [ ] API Key未泄露
- [ ] 数据库连接使用SSL
- [ ] 输入验证已启用
- [ ] SQL注入防护已启用
- [ ] XSS防护已启用

---

## 七、部署配置

### 本地部署

- [ ] 应用可以正常启动
- [ ] 可以访问 http://localhost:5000
- [ ] 所有功能正常工作
- [ ] 无控制台错误

### 外网部署

如果已部署到外网：

- [ ] 已选择部署平台（Vercel/Railway/Netlify/阿里云等）
- [ ] 已部署成功
- [ ] 可以通过外网域名访问
- [ ] 域名DNS解析已生效
- [ ] HTTPS已配置
- [ ] 环境变量已正确设置到部署平台
- [ ] 数据库可以远程连接
- [ ] 所有功能正常工作

### 自定义域名（可选）

如果绑定了自定义域名：

- [ ] 域名已购买
- [ ] DNS已正确配置
- [ ] 域名已验证
- [ ] HTTPS证书已申请
- [ ] 证书已生效

---

## 八、功能测试

### 用户功能

- [ ] 用户可以注册
- [ ] 用户可以登录
- [ ] 用户可以退出登录
- [ ] 用户可以修改密码
- [ ] 用户可以重置密码（如果配置了邮件服务）

### AI写作功能

- [ ] 角色设定功能正常
- [ ] 情节设计功能正常
- [ ] 黄金开头功能正常
- [ ] 章节撰写功能正常
- [ ] 精修润色功能正常
- [ ] 智能续写功能正常

### 作品管理功能

- [ ] 可以创建新作品
- [ ] 可以编辑作品信息
- [ ] 可以删除作品
- [ ] 可以管理章节
- [ ] 可以查看统计数据

### 文件功能

- [ ] 可以导入文件（Word/PDF/TXT）
- [ ] 可以导出文件（Word/PDF/TXT）
- [ ] 可以上传图片
- [ ] 可以下载文件

### 评分功能

- [ ] 编辑评分功能正常
- [ ] 读者评分功能正常
- [ ] 评分显示正确
- [ ] 评分反馈合理

---

## 九、性能测试

### 页面加载速度

- [ ] 首页加载时间 < 3秒
- [ ] 工作台加载时间 < 3秒
- [ ] 各功能页面加载时间 < 3秒

### AI响应速度

- [ ] AI首字响应时间 < 1秒
- [ ] 内容生成速度合理
- [ ] 流式输出流畅

### 数据库查询速度

- [ ] 用户登录查询 < 500ms
- [ ] 作品列表查询 < 500ms
- [ ] 章节内容查询 < 500ms

### 文件上传下载速度

- [ ] 文件上传速度正常
- [ ] 文件下载速度正常

---

## 十、兼容性测试

### 浏览器兼容性

- [ ] Chrome浏览器正常
- [ ] Firefox浏览器正常
- [ ] Safari浏览器正常
- [ ] Edge浏览器正常

### 设备兼容性

- [ ] PC端正常
- [ ] 平板端正常
- [ ] 手机端正常

### 屏幕分辨率

- [ ] 1920x1080（桌面）正常
- [ ] 1366x768（笔记本）正常
- [ ] 768x1024（平板竖屏）正常
- [ ] 375x667（手机）正常

---

## 十一、质量指标

### 作品质量指标

- [ ] AI生成的内容质量达到9.8分+
- [ ] 编辑评分系统准确
- [ ] 读者评分系统准确
- [ ] 精修润色功能有效
- [ ] 内容连贯性和逻辑性良好

### 平台指标

- [ ] 番茄小说Top3目标清晰
- [ ] 前三章完读率目标90%+
- [ ] 爽点设计符合平台要求
- [ ] 题材选择合适

### 用户体验指标

- [ ] 界面友好易用
- [ ] 操作流畅无卡顿
- [ ] 响应及时
- [ ] 错误提示清晰

---

## 十二、监控和维护

### 日志监控

- [ ] 已配置错误监控（如Sentry）
- [ ] 已配置性能监控（如Google Analytics）
- [ ] 日志正常记录
- [ ] 错误日志可查看

### 备份策略

- [ ] 数据库定期备份
- [ ] 环境变量已备份
- [ ] 重要文件已备份
- [ ] 备份文件安全存储

### 更新维护

- [ ] 依赖包定期更新
- [ ] 安全漏洞及时修复
- [ ] 用户反馈及时处理
- [ ] 功能持续优化

---

## 十三、文档完善

- [ ] 已阅读完整配置指南
- [ ] 已阅读快速开始指南
- [ ] 已阅读部署指南
- [ ] 已阅读常见问题解答
- [ ] 配置文档已更新（如果修改了配置）
- [ ] 已记录特殊配置和注意事项

---

## 十四、生产环境检查

### 外网访问测试

- [ ] 使用手机外网访问正常
- [ ] 使用他人电脑访问正常
- [ ] 不同网络环境访问正常

### 用户注册流程测试

- [ ] 新用户可以注册
- [ ] 邮箱验证流程顺畅（如果配置了邮件服务）
- [ ] 注册后可以正常登录

### 核心功能测试

- [ ] AI生成功能正常
- [ ] 文件导入导出正常
- [ ] 响应速度符合要求
- [ ] 无明显bug

### 性能压力测试

- [ ] 并发访问正常
- [ ] 资源占用合理
- [ ] 无内存泄漏
- [ ] 无连接池耗尽

---

## 检查结果汇总

### 配置完成度

- 必需配置：__/15
- 可选配置：__/10
- 总体完成度：__/25

### 功能测试通过率

- 核心功能：__/20
- 用户体验：__/10
- 总体通过率：__/30

### 性能指标达标率

- 响应速度：__/5
- 稳定性：__/5
- 总体达标率：__/10

---

## 注意事项

1. **安全性**
   - 确保所有敏感信息未泄露
   - 定期更新密码和密钥
   - 启用HTTPS
   - 配置防火墙规则

2. **性能**
   - 监控服务器资源使用
   - 优化数据库查询
   - 使用CDN加速
   - 定期清理无用数据

3. **维护**
   - 定期备份数据
   - 更新依赖包
   - 修复安全漏洞
   - 收集用户反馈

4. **优化**
   - 根据用户反馈改进功能
   - 优化AI生成质量
   - 提升用户体验
   - 扩展更多功能

---

## 问题记录

如果遇到问题，请记录：

| 问题 | 状态 | 解决方案 |
|------|------|---------|
| 问题1 | ❌ | 待解决 |
| 问题2 | ✅ | 已解决：... |
| 问题3 | ⚠️ | 部分解决：... |

---

## 下一步行动

根据检查结果，确定下一步：

- [ ] 如果有未完成项，继续配置
- [ ] 如果有问题待解决，查看【常见问题.md】
- [ ] 如果所有项目都已完成，准备上线
- [ ] 如果已上线，继续监控和优化

---

**祝你配置顺利！** 🎉

---

**文档版本**：v1.0
**最后更新**：2025年
