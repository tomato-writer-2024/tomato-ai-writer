# 文件导入导出功能使用指南

## 功能概述

番茄小说AI写作助手现已全面支持文件导入和导出功能，支持Word、PDF、TXT等多种格式，让您可以轻松地将现有作品导入系统，或将生成的内容导出保存。

## 功能特点

### 1. 文件导入功能

**支持的文件格式：**
- `.txt` - 纯文本文件
- `.pdf` - PDF文档
- `.doc` - Word 97-2003文档
- `.docx` - Word 2007及以上文档

**文件大小限制：**
- 最大支持 10MB 的文件

**主要功能：**
- 自动识别文件格式
- 智能提取文本内容
- 保留原有排版和段落结构
- 支持批量导入多个文件
- 导入的内容会保存到 localStorage，供各个工具使用

### 2. 文件导出功能

**支持的导出格式：**
- `.txt` - 纯文本格式
- `.docx` - Word文档格式（推荐）
- `.pdf` - PDF文档格式

**主要功能：**
- 一键导出生成的内容
- 支持多种格式选择
- 自动设置文件名
- 保留内容格式和结构

## 使用方法

### 工作台文件导入

1. 访问工作台页面 (`/workspace`)
2. 在页面中找到"文件导入"区域
3. 点击上传区域或拖拽文件到上传框
4. 系统会自动解析文件内容
5. 导入成功后，内容会保存到 localStorage，供其他工具使用

### 章节撰写页面导入导出

**导入文件：**
1. 进入章节撰写页面（新建或编辑章节）
2. 在章节内容输入框下方，点击"显示文件导入"
3. 选择要导入的文件（支持 Word/PDF/TXT）
4. 文件内容会自动添加到章节末尾

**导出文件：**
1. 在章节撰写页面右上角，可以看到导出按钮
2. 点击相应的导出按钮（Word 或 PDF）
3. 文件会自动下载到本地

### 其他生成工具页面

所有生成类工具页面（如标题生成器、大纲生成器等）都支持：
1. 在输入区域使用文件导入功能（通过工作台导入）
2. 在生成结果区域使用文件导出功能

## API 接口

### 文件解析接口

**URL:** `POST /api/files/parse`

**请求方式:** `multipart/form-data`

**参数:**
- `file`: 文件对象

**响应示例:**
```json
{
  "success": true,
  "content": "解析后的文本内容",
  "filename": "文档.txt",
  "size": 1024,
  "type": "txt"
}
```

### 文件导出接口

**URL:** `POST /api/files/export`

**请求方式:** `application/json`

**参数:**
```json
{
  "content": "要导出的文本内容",
  "format": "docx",  // 支持: txt, docx, pdf
  "filename": "文档名称"
}
```

**响应:** 返回文件流（Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document 或 application/pdf）

## 技术实现

### 依赖库

- **pdf-parse**: PDF 文件解析
- **mammoth**: Word 文档解析
- **docx**: Word 文档生成
- **jspdf**: PDF 文档生成

### 前端组件

- `FileUploader.tsx`: 文件上传组件
- `FileExporter.tsx`: 文件导出组件
- `QuickExportButton.tsx`: 快捷导出按钮

### 后端接口

- `/api/files/parse`: 文件解析API
- `/api/files/export`: 文件导出API

## 注意事项

1. **文件大小限制**: 单个文件最大 10MB
2. **编码格式**: 确保文本文件使用 UTF-8 编码
3. **PDF 限制**: 仅支持文本内容的 PDF，扫描版 PDF 无法解析
4. **Word 格式**: 旧版 .doc 格式可能无法完美解析，建议使用 .docx 格式
5. **内容安全**: 导入的内容会自动进行安全检查，防止恶意代码注入

## 常见问题

### Q1: 上传的 PDF 文件无法解析？
A: 请确保 PDF 文件包含可提取的文本内容，而不是扫描图片。您可以使用 Adobe Acrobat 等工具将 PDF 转换为可搜索的格式。

### Q2: Word 文档导入后格式丢失？
A: 文件导入功能主要提取文本内容，复杂的格式（如表格、图片、特殊排版）可能无法保留。

### Q3: 导出的 Word 文档在某些软件中无法打开？
A: 确保您使用的是支持 .docx 格式的 Word 版本（Word 2007 及以上）。

### Q4: 如何批量导入多个文件？
A: 目前工作台支持单次导入一个文件，您可以多次上传，内容会累积保存。

## 未来计划

- [ ] 支持更多文件格式（如 Markdown、HTML）
- [ ] 添加批量文件导入功能
- [ ] 支持导出时选择更多格式选项（如字体、字号、页边距等）
- [ ] 添加云端存储支持
- [ ] 支持在线预览功能

## 技术支持

如有问题或建议，请联系技术支持团队。
