# 文件导入导出功能说明

## 功能概述

番茄AI写作助手现已支持多格式文件的导入导出功能，方便您在不同场景下使用。

## 支持的格式

### 导入格式
- ✅ Word 文档 (.docx)
- ✅ PDF 文档 (.pdf)
- ✅ 纯文本 (.txt)

### 导出格式
- ✅ Word 文档 (.docx)
- ✅ PDF 文档 (.pdf)
- ✅ 纯文本 (.txt)

## 使用场景

### 场景一：导入已有章节

**需求**：你已经用其他工具写了一些章节，想要导入到AI助手中继续创作。

**操作步骤**：
1. 打开工作台页面
2. 点击右侧输出区的"📥 导入"按钮
3. 选择你的章节文件（.docx/.pdf/.txt）
4. 等待文件读取完成
5. 内容会自动显示在输出区
6. 可以继续编辑或使用AI润色、续写

**提示**：
- 支持大文件导入
- 自动保留文本内容
- PDF会自动提取文本内容

### 场景二：批量导出章节

**需求**：你创作了多个章节，想要导出保存到本地。

**操作步骤**：
1. 在工作台中编辑完一个章节
2. 点击"📤 导出"按钮
3. 选择导出格式（Word/PDF/TXT）
4. 文件自动下载，命名格式为"第X章.扩展名"
5. 对每个章节重复此操作

**提示**：
- 可以使用"复制"按钮快速复制内容
- 建议按章节分别导出，便于管理

### 场景三：备份和恢复

**需求**：定期备份创作内容，防止意外丢失。

**操作步骤**：
1. 导出当前章节为 Word 格式
2. 保存到云盘或本地文件夹
3. 如需恢复，使用导入功能重新加载

**提示**：
- 建议定期导出备份
- Word 格式保留格式信息
- 可以使用版本号命名（如：第1章_v1.docx）

### 场景四：分享和投稿

**需求**：想要分享作品给他人或提交到平台。

**操作步骤**：
1. 完成章节创作和润色
2. 导出为 PDF 格式（适合正式提交）
3. 或导出为 Word 格式（适合编辑）
4. 发送给编辑或上传到平台

**提示**：
- PDF 格式排版稳定，适合正式使用
- Word 格式便于对方编辑

## 技术细节

### 文件处理库

我们使用以下库来处理不同格式的文件：

| 格式 | 读取 | 生成 | 库名称 |
|------|------|------|--------|
| Word (.docx) | mammoth | docx | npm install mammoth docx |
| PDF | pdf-parse | jsPDF | npm install pdf-parse jspdf |
| TXT | FileReader API | Blob API | 原生支持 |

### 功能特点

1. **客户端处理**：所有文件处理都在浏览器端完成，不会上传到服务器，保护隐私
2. **实时反馈**：导入导出进度实时显示
3. **智能识别**：自动识别文件类型，无需手动选择
4. **错误处理**：完善的错误提示，帮助用户快速定位问题

### 注意事项

1. **文件大小限制**
   - 建议单个文件不超过 10MB
   - 大文件处理可能需要更多时间

2. **PDF 导出说明**
   - 当前版本使用默认字体，中文可能显示为方块
   - 建议优先使用 Word 或 TXT 格式导出中文内容
   - 后续版本将添加中文字体支持

3. **格式兼容性**
   - Word 2007 及以上版本支持 .docx 格式
   - PDF 兼容主流 PDF 阅读器
   - TXT 兼容所有文本编辑器

## 常见问题

### Q1: 导入 PDF 时文字乱码怎么办？
A: 某些 PDF 可能使用特殊字体或图片格式，导致文字提取失败。建议尝试复制 PDF 内容到 TXT 文件中，再导入 TXT 文件。

### Q2: 导出的 PDF 中文显示不正常？
A: 当前版本 PDF 导出使用默认字体，中文显示为方块。建议使用 Word 或 TXT 格式导出中文内容。

### Q3: 可以批量导入多个文件吗？
A: 当前版本一次只能导入一个文件。如需处理多个文件，请逐个导入。

### Q4: 导出的文件保存在哪里？
A: 文件会自动下载到浏览器的默认下载文件夹。

### Q5: 导入后可以编辑内容吗？
A: 可以！导入的内容会显示在输出区，你可以自由编辑，也可以继续使用 AI 功能进行润色或续写。

## 最佳实践

1. **定期备份**
   - 建议每天导出当前章节
   - 使用版本号命名
   - 保存到多个位置

2. **格式选择建议**
   - 日常创作：导出为 Word 格式
   - 投稿发布：导出为 PDF 格式
   - 快速查看：导出为 TXT 格式

3. **工作流程推荐**
   - 创作 → AI润色 → 导出Word → 本地备份 → 继续创作

4. **文件命名规范**
   - 使用清晰的命名规则
   - 包含章节号和日期
   - 示例：第1章_20250108.docx

## 未来计划

- [ ] 支持批量导入
- [ ] 支持 RTF 格式
- [ ] PDF 导出添加中文字体支持
- [ ] 导入时自动识别章节标题
- [ ] 支持云端存储
- [ ] 支持版本历史管理

## 技术支持

如遇到问题，请通过以下方式联系：
- 查看系统日志
- 检查浏览器控制台
- 联系客服支持

---

让文件导入导出功能助力您的创作之旅！
